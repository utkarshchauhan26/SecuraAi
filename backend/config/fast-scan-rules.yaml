rules:
  - id: hardcoded-password
    pattern: password = "..."
    message: Hardcoded password detected
    severity: ERROR
    languages: [javascript, typescript, python, java]
    
  - id: sql-injection-concat
    pattern: |
      $DB.query("..." + $INPUT + "...")
    message: Possible SQL injection vulnerability
    severity: ERROR
    languages: [javascript, typescript]
    
  - id: xss-inner-html
    pattern: innerHTML = $INPUT
    message: Possible XSS vulnerability - avoid innerHTML
    severity: WARNING
    languages: [javascript, typescript]
    
  - id: xss-dangerously-set
    pattern: dangerouslySetInnerHTML
    message: Possible XSS vulnerability - dangerouslySetInnerHTML
    severity: WARNING
    languages: [javascript, typescript]
    
  - id: eval-usage
    pattern-either:
      - pattern: eval($INPUT)
      - pattern: Function($INPUT)
    message: Use of eval() is dangerous
    severity: ERROR
    languages: [javascript, typescript]
    
  - id: api-key-exposure
    pattern-regex: (api[_-]?key|apikey|api[_-]?secret|sk_live)\s*=\s*[\"'][a-zA-Z0-9_-]{20,}[\"']
    message: Possible API key exposure
    severity: ERROR
    languages: [javascript, typescript, python, java, go]
